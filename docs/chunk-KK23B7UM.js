import{Ib as n,S as a,pa as i}from"./chunk-6J5GD54P.js";var u=class o{users=i([]);currentUser=i(null);isLoggedIn=n(()=>!!this.currentUser());isAdmin=n(()=>this.currentUser()?.role==="Admin");constructor(){this.loadUsersFromStorage(),this.loadCurrentUserFromStorage()}loadUsersFromStorage(){let e=localStorage.getItem("tipsy_users");if(e)this.users.set(JSON.parse(e));else{let s=[{id:"u1",email:"admin@tipsy.com",password:"password",role:"Admin",anonymousId:"Admin"},{id:"u2",email:"user1@tipsy.com",password:"password",role:"Employee",reputation:25,anonymousId:"Employee #18432"},{id:"u3",email:"user2@tipsy.com",password:"password",role:"Employee",reputation:10,anonymousId:"Employee #58291"},{id:"u4",email:"user3@tipsy.com",password:"password",role:"Employee",reputation:50,anonymousId:"Employee #93104"}];this.users.set(s),this.saveUsersToStorage()}}saveUsersToStorage(){localStorage.setItem("tipsy_users",JSON.stringify(this.users()))}loadCurrentUserFromStorage(){let e=localStorage.getItem("tipsy_currentUser");e&&this.currentUser.set(JSON.parse(e))}getUsers(){return this.users()}syncUsers(e){this.users.set(e),this.saveUsersToStorage();let s=this.currentUser();if(s){let r=e.find(t=>t.id===s.id);r&&(this.currentUser.set(r),localStorage.setItem("tipsy_currentUser",JSON.stringify(r)))}}login(e,s){let r=this.users().find(t=>t.email===e&&t.password===s);return r?(this.currentUser.set(r),localStorage.setItem("tipsy_currentUser",JSON.stringify(r)),!0):!1}register(e,s){if(this.users().some(t=>t.email===e))return null;let r={id:`u${this.users().length+1}`,email:e,password:s,role:"Employee",reputation:1,anonymousId:`Employee #${Math.floor(1e4+Math.random()*9e4)}`};return this.users.update(t=>[...t,r]),this.saveUsersToStorage(),this.login(e,s),r}logout(){this.currentUser.set(null),localStorage.removeItem("tipsy_currentUser")}static \u0275fac=function(s){return new(s||o)};static \u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"})};export{u as a};
