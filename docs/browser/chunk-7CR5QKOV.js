import{d as q,g as K}from"./chunk-KU3XBMJO.js";import{a as ie}from"./chunk-L4IO4DCB.js";import{a as X,b as Y,e as Z,h as ee}from"./chunk-HTEFNZY6.js";import{a as te,b as v,c as ne,d as oe}from"./chunk-UCWR6BSW.js";import{a as Q}from"./chunk-HU3G3ZVB.js";import{Cb as F,Ha as W,J as b,Qa as h,Ra as C,Rb as J,Ta as S,Tb as $,U as w,Ua as D,Va as V,Wa as o,Xa as i,Ya as m,Z as p,_ as u,ab as I,cb as f,db as s,ha as E,jb as j,kb as B,lb as l,mb as x,n as A,nb as c,ob as U,pb as N,qb as R,rb as z,sb as H,tb as G,va as P,xa as r,xb as T,zb as k}from"./chunk-ZBVGA4EN.js";var M=(n,t)=>t.id;function re(n,t){n&1&&(o(0,"div",0),m(1,"app-skeleton-loader",1),o(2,"div",2)(3,"div",3)(4,"div",4),m(5,"app-skeleton-loader",5)(6,"app-skeleton-loader",6)(7,"app-skeleton-loader",7),i(),o(8,"div",4),m(9,"app-skeleton-loader",8)(10,"app-skeleton-loader",5)(11,"app-skeleton-loader",9),i()(),o(12,"div",10)(13,"div",4),m(14,"app-skeleton-loader",11)(15,"app-skeleton-loader",12),i()()()())}function le(n,t){n&1&&m(0,"app-skeleton-loader",7)}function de(n,t){if(n&1&&(o(0,"p",25),l(1),i()),n&2){let e,a=s(2);r(),x((e=a.aiSummary())==null?null:e.summary)}}function se(n,t){if(n&1&&(o(0,"div",32),m(1,"img",51),o(2,"div",52)(3,"span",53),l(4),i()()()),n&2){let e=t.$implicit;r(),V("src",e.url,P)("alt",e.filename),r(3),x(e.filename)}}function me(n,t){n&1&&m(0,"app-skeleton-loader",37)}function ce(n,t){if(n&1&&(o(0,"span",54),l(1),i()),n&2){s();let e=G(0),a=s();B(a.getSeverityClass(e.criticality)),r(),c(" ",e.criticality," ")}}function pe(n,t){n&1&&m(0,"app-skeleton-loader",39)}function ue(n,t){if(n&1&&(o(0,"span",40),l(1),i()),n&2){let e,a=s(2);r(),c("",(e=a.aiEvidenceIntegrity())==null?null:e.integrityScore,"/100")}}function xe(n,t){if(n&1&&(o(0,"div",42)(1,"p",55),l(2),i(),o(3,"p",56),l(4),T(5,"date"),i()()),n&2){let e=t.$implicit;r(),V("title",e.hash),r(),c(" Hash: ",e.hash," "),r(2),c(" ",k(5,3,e.timestamp,"short")," ")}}function ge(n,t){if(n&1&&(o(0,"div",45)(1,"p",57),l(2),i(),o(3,"div",58)(4,"span"),l(5),i(),o(6,"span"),l(7),T(8,"date"),i()()()),n&2){let e=t.$implicit;r(2),x(e.text),r(3),x(e.author),r(2),x(k(8,3,e.createdAt,"short"))}}function _e(n,t){if(n&1){let e=I();o(0,"button",59),f("click",function(){p(e);let d=s(2);return u(d.toggleChat())}),m(1,"i",60),i()}}function he(n,t){if(n&1&&(o(0,"div",71)(1,"div",72)(2,"p",73),l(3),i(),o(4,"p",74),l(5),T(6,"date"),i()()()),n&2){let e,a,d,g,L,O,_=t.$implicit,y=s(4);j("justify-end",_.senderId===((e=y.currentUser())==null?null:e.anonymousId))("justify-start",_.senderId!==((a=y.currentUser())==null?null:a.anonymousId)),r(),j("bg-[#6C5DD3]",_.senderId===((d=y.currentUser())==null?null:d.anonymousId))("text-white",_.senderId===((g=y.currentUser())==null?null:g.anonymousId))("bg-[#1A1C2C]",_.senderId!==((L=y.currentUser())==null?null:L.anonymousId))("text-gray-300",_.senderId!==((O=y.currentUser())==null?null:O.anonymousId)),r(2),x(_.text),r(2),c(" ",k(6,14,_.timestamp,"shortTime")," ")}}function Ce(n,t){n&1&&(o(0,"p",70),l(1," Send a message to start the conversation. "),i())}function fe(n,t){n&1&&S(0,he,7,17,"div",69,M,!1,Ce,2,0,"p",70),n&2&&D(t.messages)}function ve(n,t){if(n&1){let e=I();o(0,"div",50)(1,"header",61)(2,"h3",62),l(3,"Chat with Admin"),i(),o(4,"button",63),f("click",function(){p(e);let d=s(2);return u(d.toggleChat())}),l(5," \xD7 "),i()(),o(6,"main",64),h(7,fe,3,1),i(),o(8,"footer",65)(9,"div",66)(10,"input",67),R("ngModelChange",function(d){p(e);let g=s(2);return N(g.newChatMessage,d)||(g.newChatMessage=d),u(d)}),f("keyup.enter",function(){p(e);let d=s(2);return u(d.sendChatMessage())}),i(),o(11,"button",68),f("click",function(){p(e);let d=s(2);return u(d.sendChatMessage())}),l(12," Send "),i()()()()}if(n&2){let e,a=s(2);r(7),C((e=a.chatSession())?7:-1,e),r(3),U("ngModel",a.newChatMessage)}}function be(n,t){if(n&1){let e=I();z(0),o(1,"div",0)(2,"div",13)(3,"h1",14),l(4),i(),o(5,"div",15)(6,"span",16),l(7),i(),o(8,"button",17),f("click",function(){p(e);let d=s();return u(d.upvote())}),m(9,"i",18),l(10),i(),o(11,"button",19),f("click",function(){p(e);let d=s();return u(d.downvote())}),m(12,"i",20),l(13),i()()(),o(14,"div",2)(15,"div",21)(16,"div",22)(17,"h3",23),m(18,"i",24),l(19," AI-Generated Summary "),i(),h(20,le,1,0,"app-skeleton-loader",7)(21,de,2,1,"p",25),i(),o(22,"div",26)(23,"h3",27),l(24,"Full Report Details"),i(),o(25,"p",28),l(26),i(),o(27,"div",29)(28,"span"),l(29),i(),o(30,"span"),l(31),T(32,"date"),i()()(),o(33,"div",26)(34,"h3",30),l(35,"Evidence Gallery"),i(),o(36,"div",31),S(37,se,5,3,"div",32,M),i()()(),o(39,"div",33)(40,"div",22)(41,"h3",30),l(42,"AI Analysis"),i(),o(43,"div",34)(44,"div",35)(45,"span",36),l(46,"AI-Predicted Criticality"),i(),h(47,me,1,0,"app-skeleton-loader",37)(48,ce,2,3,"span",38),i(),o(49,"div",35)(50,"span",36),l(51,"Evidence Integrity Score"),i(),h(52,pe,1,0,"app-skeleton-loader",39)(53,ue,2,1,"span",40),i()()(),o(54,"div",26)(55,"h3",30),l(56,"Blockchain History"),i(),o(57,"div",41),S(58,xe,6,6,"div",42,M),i(),o(60,"a",43),l(61,"View Full Chain"),i()(),o(62,"div",26)(63,"h3",30),l(64),i(),o(65,"div",44),S(66,ge,9,6,"div",45,M),i(),o(68,"div",46)(69,"textarea",47),R("ngModelChange",function(d){p(e);let g=s();return N(g.newComment,d)||(g.newComment=d),u(d)}),i(),o(70,"button",48),f("click",function(){p(e);let d=s();return u(d.submitComment())}),l(71," Submit Comment "),i()()()()()(),h(72,_e,2,0,"button",49),h(73,ve,13,2,"div",50)}if(n&2){let e=s(),a=H(e.report());r(4),x(a.title),r(2),B(e.getStatusClass(a.status)),r(),c(" Status: ",a.status," "),r(3),c(" ",a.upvotes," "),r(3),c(" ",a.downvotes," "),r(7),C(e.aiSummary()?21:20),r(6),x(a.description),r(3),c("Submitted by: ",a.submitter),r(2),c("On: ",k(32,17,a.createdAt,"fullDate")),r(6),D(a.evidence),r(10),C(e.aiSeverity()?48:47),r(5),C(e.aiEvidenceIntegrity()?53:52),r(6),D(e.reportBlockchain()),r(6),c(" Anonymous Comments (",a.comments.length,") "),r(2),D(a.comments),r(3),U("ngModel",e.newComment),r(3),C(e.isSubmitter()?72:-1),r(),C(e.isChatOpen()?73:-1)}}var ae=class n{constructor(){this.route=w(q);this.dataService=w(oe);this.aiService=w(ne);this.authService=w(Q);this.reportId=v(this.route.paramMap.pipe(b(t=>A(t.get("id")))));this.report=v(this.route.paramMap.pipe(b(t=>this.dataService.getReport(t.get("id")))));this.aiSummary=v(this.route.paramMap.pipe(b(t=>this.aiService.getSummary(t.get("id")))));this.aiSeverity=v(this.route.paramMap.pipe(b(t=>this.aiService.predictSeverity(t.get("id")))));this.aiEvidenceIntegrity=v(this.route.paramMap.pipe(b(t=>this.aiService.analyzeEvidence(t.get("id")))));this.blockchain=v(this.dataService.getBlockchain());this.isChatOpen=E(!1,{});this.newChatMessage=E("",{});this.currentUser=this.authService.currentUser;this.isSubmitter=F(()=>this.report()?.submitterId===this.currentUser()?.id,{});this.chatSession=v(te(this.reportId).pipe(b(t=>t?this.dataService.getChatSessionStream(t):A(void 0))));this.newComment=E("",{});this.reportBlockchain=F(()=>{let t=this.blockchain(),e=this.report();return!t||!e?[]:t.filter(a=>{try{let d=JSON.parse(a.data);return d.id===e.id||d.reportId===e.id}catch{return!1}})},{})}upvote(){this.reportId()&&this.dataService.upvoteReport(this.reportId())}downvote(){this.reportId()&&this.dataService.downvoteReport(this.reportId())}submitComment(){let t=this.reportId(),e=this.newComment().trim();t&&e&&this.dataService.addComment(t,e).subscribe(()=>{this.newComment.set("")})}toggleChat(){let t=this.reportId();t&&(this.dataService.initiateChatSession(t),this.isChatOpen.update(e=>!e))}sendChatMessage(){let t=this.chatSession()?.id,e=this.newChatMessage().trim();t&&e&&(this.dataService.addChatMessage(t,e),this.newChatMessage.set(""))}getSeverityClass(t){if(!t)return"bg-gray-500/20 text-gray-400";switch(t){case"High":return"bg-red-500 text-white";case"Medium":return"bg-yellow-500 text-white";case"Low":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}}getStatusClass(t){if(!t)return"bg-gray-500/20 text-gray-400";switch(t){case"Open":return"bg-green-500/20 text-green-400";case"Under Review":return"bg-orange-500/20 text-orange-400";case"Resolved":return"bg-purple-500/20 text-purple-400";default:return"bg-gray-500/20 text-gray-400"}}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=W({type:n,selectors:[["app-thread-detail"]],decls:2,vars:1,consts:[[1,"container","mx-auto"],["customClass","h-10 w-3/4 mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","space-y-6"],[1,"bg-[#23263A]","p-6","rounded-lg"],["customClass","h-4 w-full mb-2"],["customClass","h-4 w-5/6 mb-2"],["customClass","h-4 w-full"],["customClass","h-6 w-1/3 mb-4"],["customClass","h-4 w-4/6"],[1,"space-y-6"],["customClass","h-6 w-1/2 mb-4"],["customClass","h-20 w-full"],[1,"flex","flex-col","md:flex-row","justify-between","md:items-center","gap-4","mb-6"],[1,"text-2xl","lg:text-4xl","font-bold","text-white"],[1,"flex","items-center","space-x-2","flex-shrink-0"],[1,"px-4","py-2","rounded-full","text-sm","font-semibold"],[1,"bg-gray-700","hover:bg-green-500","text-white","font-bold","py-2","px-4","rounded-lg","flex","items-center","transition-colors",3,"click"],[1,"fas","fa-arrow-up","mr-2"],[1,"bg-gray-700","hover:bg-red-500","text-white","font-bold","py-2","px-4","rounded-lg","flex","items-center","transition-colors",3,"click"],[1,"fas","fa-arrow-down","mr-2"],[1,"lg:col-span-2","space-y-8"],[1,"bg-[#23263A]","p-6","rounded-lg","shadow-xl","border","border-gray-700"],[1,"text-xl","font-bold","text-white","mb-3","flex","items-center"],[1,"fas","fa-brain","text-[#6C5DD3]","mr-3"],[1,"text-gray-300"],[1,"bg-[#23263A]","p-6","rounded-lg","shadow-xl"],[1,"text-xl","font-bold","text-white","mb-3"],[1,"text-gray-400","whitespace-pre-wrap"],[1,"text-sm","text-gray-500","mt-4","pt-4","border-t","border-gray-700","flex","justify-between"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-4"],[1,"relative","overflow-hidden","rounded-lg","group"],[1,"space-y-8"],[1,"space-y-4"],[1,"flex","flex-col","items-center","p-3","rounded-lg","bg-[#1A1C2C]"],[1,"text-sm","text-gray-400","mb-1"],["customClass","h-8 w-24"],[1,"px-4","py-1.5","rounded-md","font-bold","text-lg","glow-tag",3,"class"],["customClass","h-8 w-16"],[1,"text-2xl","font-bold","text-[#6C5DD3]"],[1,"space-y-3","max-h-80","overflow-y-auto","pr-2"],[1,"bg-[#1A1C2C]","p-2","rounded","text-xs","font-mono"],["routerLink","/blockchain-explorer",1,"text-sm","text-[#6C5DD3]","hover:underline","mt-4","block","text-center"],[1,"space-y-4","max-h-80","overflow-y-auto","mb-4","pr-2"],[1,"bg-[#1A1C2C]","p-3","rounded-lg"],[1,"mt-4","pt-4","border-t","border-gray-700"],["rows","3","placeholder","Add an anonymous comment...",1,"w-full","bg-[#1A1C2C]","border","border-gray-600","rounded-lg","p-2","text-white","focus:ring-2","focus:ring-[#6C5DD3]","focus:outline-none",3,"ngModelChange","ngModel"],[1,"w-full","mt-2","bg-[#6C5DD3]","hover:bg-[#584bad]","text-white","font-bold","py-2","rounded-lg","transition-colors",3,"click"],[1,"fixed","bottom-6","right-6","bg-[#6C5DD3]","text-white","rounded-full","h-16","w-16","flex","items-center","justify-center","shadow-lg","hover:bg-[#584bad]","transition-transform","transform","hover:scale-110","z-50"],[1,"fixed","bottom-24","right-6","w-96","h-[500px]","bg-[#23263A]","rounded-lg","shadow-2xl","flex","flex-col","border","border-gray-700","z-50"],[1,"w-full","h-40","object-cover","group-hover:scale-110","transition-transform","duration-300",3,"src","alt"],[1,"absolute","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"text-white","text-sm"],[1,"px-4","py-1.5","rounded-md","font-bold","text-lg","glow-tag"],[1,"text-green-400","truncate",3,"title"],[1,"text-gray-500","text-[10px]"],[1,"text-gray-300","text-sm"],[1,"text-xs","text-gray-500","mt-2","flex","justify-between"],[1,"fixed","bottom-6","right-6","bg-[#6C5DD3]","text-white","rounded-full","h-16","w-16","flex","items-center","justify-center","shadow-lg","hover:bg-[#584bad]","transition-transform","transform","hover:scale-110","z-50",3,"click"],[1,"fas","fa-comments","text-2xl"],[1,"bg-[#1A1C2C]","p-4","flex","justify-between","items-center","rounded-t-lg"],[1,"text-lg","font-bold","text-white"],[1,"text-gray-400","hover:text-white",3,"click"],[1,"flex-1","p-4","space-y-4","overflow-y-auto"],[1,"p-4","bg-[#1A1C2C]","rounded-b-lg"],[1,"flex","space-x-2"],["type","text","placeholder","Type your message...",1,"flex-1","bg-[#23263A]","border","border-gray-600","rounded-lg","px-3","py-2","text-white","focus:outline-none","focus:ring-2","focus:ring-[#6C5DD3]",3,"ngModelChange","keyup.enter","ngModel"],[1,"bg-[#6C5DD3]","hover:bg-[#584bad]","text-white","font-bold","px-4","rounded-lg","transition-colors",3,"click"],[1,"flex",3,"justify-end","justify-start"],[1,"text-center","text-sm","text-gray-500"],[1,"flex"],[1,"max-w-xs","p-3","rounded-lg"],[1,"text-sm"],[1,"text-xs","opacity-60","mt-1","text-right"]],template:function(e,a){e&1&&h(0,re,16,0,"div",0)(1,be,74,20),e&2&&C(a.report()?1:0)},dependencies:[$,K,ee,X,Y,Z,ie,J],encapsulation:2,changeDetection:0})}};export{ae as ThreadDetailComponent};
